language: "node_js"
os: "trusty"
cache: "yarn"
node_js:
  - "node"

stages:
  - "compile"
  - "test"
  - name: "deploy"
    if: "(branch = release) AND (repo = Cromefire/preact-mwc-styled)"

jobs:
  include:
    - stage: "compile"
      script: "yarn build"

    - stage: "test"
      script: "./test.sh"

    - stage: "deploy"
      script: "skip"
      deploy:
        provider: "npm"
        skip_cleanup: true
        provider: "npm"
        email: "cromefirehd@gmail.com"
        api_key:
          secure: "DkaMM342VXfrSfjZ2Fm5DCu2ZRNq0L0JTSbd6I6exOVcdnA56Tfbu5eEhbaUYkQA6sAP5wAYhRN5uG8DIYNpufJBsYuTxSw15paf/exSN4W2kKjkdpRA4JITgHhOlWkbNmC3i6U0Hxyv5myykDTAG"
        on:
          repo: "Cromefire/preact-mwc-styled"
          branch: "release"
